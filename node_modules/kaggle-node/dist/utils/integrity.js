"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.deriveQueryParams = exports.getMD5ChecksumFromResponse = void 0;
const gcsHash = 'x-goog-hash';
function getMD5ChecksumFromResponse(res) {
    if (gcsHash in res.headers) {
        let val = res.headers[gcsHash];
        for (var checksum of val.split(",")) {
            try {
                let [name, value] = checksum.trim().split("=", 1);
                if (name == "md5") {
                    return value;
                }
            }
            catch (err) {
                console.log(`Invalid ${gcsHash} header: ${val}`);
                return null;
            }
        }
    }
    return null;
}
exports.getMD5ChecksumFromResponse = getMD5ChecksumFromResponse;
function deriveQueryParams(path, specifyParams) {
    let params = path.substring(path.indexOf('?') + 1)
        .split('&')
        .reduce((obj, option) => {
        let [prop, val] = option.split("=");
        if (specifyParams == undefined || specifyParams.includes(prop)) {
            if (!!val && !isNaN(Number(val))) {
                obj[prop] = Number(val);
            }
            else {
                obj[prop] = val;
            }
        }
        return obj;
    }, {});
    delete params['group']; // 'group' is not included in any input queries.
    return params;
}
exports.deriveQueryParams = deriveQueryParams;
//# sourceMappingURL=integrity.js.map